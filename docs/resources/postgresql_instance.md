---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vtb_postgresql_instance Resource - terraform-provider-vtb"
subcategory: ""
description: |-
  PostgreSQL Resource
---

# vtb_postgresql_instance (Resource)

PostgreSQL Resource

## Example Usage

```terraform
data "vtb_core_data" "dev" {
  platform    = "OpenStack"
  domain      = "corp.dev.vtb"
  net_segment = "dev-srv-app"
  zone        = "msk-north"
}

data "vtb_flavor_data" "c4m16" {
  cores  = 4
  memory = 16
}

data "vtb_postgresql_image_data" "img" {
  product_type                  = "cluster"
  default_transaction_isolation = "READ COMMITTED"
  distribution                  = "astra"
  version                       = "1.7"
}

resource "vtb_postgresql_instance" "name" {
  lifetime = 2
  label    = "TerraformPostgreSQL"
  core     = data.vtb_core_data.dev
  flavor   = data.vtb_flavor_data.c4m16
  image    = data.vtb_postgresql_image_data.img
  extra_mounts = {
    "/pg_data" = {
      size        = 50
    }
  }
  access = {
    "superuser" = [
      "cloud-soub-posgres",
    ],
  }
  dbs = {
    "terraform" = {
      conn_limit    = 10
      db_admin_pass = "-A1b2C3d4E5f6G7h8.I9J0kL1m2N3o4P5q6R7S8-t9U0vW1x2Y3Z4a5B6C7d8A1b2C3d4E5f6G7h8I9J0kL1m2N3o4P5q6R7S8t9U0vW1x2Y3Z4a5B6C7d8"
    }
  }
  db_users = {
    "terraform_user1" = {
      db_name       = "terraform"
      dbms_role     = "user"
      user_password = "-A1b2C3d4E5f6G7h8.I9J0kL1m2N3o4P5q6R7S8-t9U0vW1x2Y3Z4a5B6C7d8A1b2C3d4E5f6G7h8I9J0kL1m2N3o4P5q6R7S8t9U0vW1x2Y3Z4a5B6C7d8"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `core` (Attributes) Core parameters for VM and order. (see [below for nested schema](#nestedatt--core))
- `extra_mounts` (Attributes Map) Added extra mounts in compute instance. (see [below for nested schema](#nestedatt--extra_mounts))
- `financial_project` (String) Financial source for order.
- `flavor` (Attributes) Core/memory of compute instance. (see [below for nested schema](#nestedatt--flavor))
- `image` (Attributes) Type of Postgresql instance (see [below for nested schema](#nestedatt--image))
- `label` (String) Label of order.

### Optional

- `access` (Map of Set of String) Map, where key is role and value is list of groups, which will grant access for Active Directory login
- `db_users` (Attributes Map) List of users to add to postgresql (see [below for nested schema](#nestedatt--db_users))
- `dbs` (Attributes Map) List of dbs to create on postgresql instance (see [below for nested schema](#nestedatt--dbs))
- `lifetime` (Number) Order lifetime in days (2, 7, 14, 30)

### Read-Only

- `connection_url` (String) Connection url of ordered postgresql
- `item_id` (String) Item identificator of app in order.
- `order_id` (String) Identifiator of Order. Known after creating order.

<a id="nestedatt--core"></a>
### Nested Schema for `core`

Required:

- `domain` (String) Название сетевого сегмента для заказа. Пример: dev-srv-app
- `net_segment` (String) Network segment name of order
- `platform` (String) Название платформы заказа Пример: OpenStack
- `zone` (String) Зона доступности, где будет размещен заказ. Пример: msk-north


<a id="nestedatt--extra_mounts"></a>
### Nested Schema for `extra_mounts`

Required:

- `size` (Number) Mount point size (specify at GB).

Read-Only:

- `file_system` (String) Name of file system type.


<a id="nestedatt--flavor"></a>
### Nested Schema for `flavor`

Required:

- `cores` (Number) Количество ядер ЦПУ.
- `memory` (Number) Количество оперативной памяти RAM (указывается в ГБ).
- `name` (String) Кодовое название конфигурации.
- `uuid` (String) Уникальный идентификатор на странице справочников.


<a id="nestedatt--image"></a>
### Nested Schema for `image`

Required:

- `ad_integration` (Boolean) Flag for integration compute instance with Active Directory
- `default_transaction_isolation` (String) Default Transaction Isolation parameter for PostgreSQL configuration
- `distribution` (String) Name of distribution (RHEL or Astra)
- `load_profile` (String) Load profile for PostgreSQL installation
- `on_support` (Boolean) Flag mean, what the product will supported by sup group
- `postgresql_version` (String) PostgreSQL version
- `product_id` (String) Product id of compute instance
- `product_type` (String) Type of postgresql installation: stand-alone or cluster
- `version` (String) Verison of distribution image


<a id="nestedatt--db_users"></a>
### Nested Schema for `db_users`

Required:

- `db_name` (String) Name of DB to which user will be added
- `dbms_role` (String) Role of user
- `user_password` (String, Sensitive) User's password

Optional:

- `comment` (String) Comment for user


<a id="nestedatt--dbs"></a>
### Nested Schema for `dbs`

Required:

- `db_admin_pass` (String, Sensitive) Password for admin of database
- `db_custom_encoding` (Boolean) Database Custom Encoding

Optional:

- `conn_limit` (Number) Connection limit for databases
- `db_encoding` (String) Database Encoding

## Import

Import is supported using the following syntax:

```shell
tofu import vtb_postgresql_instance.name <order_id>
```
