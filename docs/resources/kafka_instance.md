---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vtb_kafka_instance Resource - terraform-provider-vtb"
subcategory: ""
description: |-
  
---

# vtb_kafka_instance (Resource)



## Example Usage

```terraform
data "vtb_core_data" "dev" {
  platform    = "OpenStack"
  domain      = "corp.dev.vtb"
  net_segment = "dev-srv-app"
  zone        = "msk-north"
}

data "vtb_flavor_data" "c4m8" {
  cores  = 4
  memory = 8
}

data "vtb_kafka_image_data" "kafka_img" {
  distribution = "astra"
  os_version   = "1.7"
}

data "vtb_cluster_layout" "kafka" {
  layout      = "one_dc:kafka:zookeeper"
  net_segment = "dev-srv-app"
}

resource "vtb_kafka_instance" "kafka_powere_test2" {
  label         = "TerraformKafka"
  kafka_version = "2.13-2.4.1"
  core          = data.vtb_core_data.dev
  flavor        = data.vtb_flavor_data.c4m8
  image         = data.vtb_kafka_image_data.kafka_img
  layout_id     = data.vtb_cluster_layout.kafka.id
  financial_project = "VTB.Cloud"
  extra_mounts = {
    "/app" = {
      size        = 25
    }
  }
  access = {
    "kafka_admin" = [
      "cloud-soub-kafka",
    ]
  }
   
   topics = {
    "test-1" = {
      cleanup_policy  = "delete"
      partitions      = 1
      retention_ms    = 1800009
    }
    "test-2" = {
      cleanup_policy  = "delete,compact"
      partitions      = 1
      retention_ms    = 1800009
    }
    "test-3" = {
      cleanup_policy  = "compact"
      partitions      = 1
    }
  }

  acls = {
    "APD2" = {
      allow_idempotent      = false 
      consumer_by_name      = ["consumer-1"]
      producer_by_name      = []
      consumer_by_mask      = []
      producer_by_mask      = []
      transactional_by_name = []
      transactional_by_mask = []
    },
    "APD1" = {
      allow_idempotent      = false 
      transactional_by_name = ["test-xxx"]
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_name` (String) Имя кластера.
- `core` (Attributes) Основные параметры для ВМ в заказе. (see [below for nested schema](#nestedatt--core))
- `extra_mounts` (Attributes Map) Дополнительные точки монтирования. (see [below for nested schema](#nestedatt--extra_mounts))
- `financial_project` (String) Источник финансирования.
- `flavor` (Attributes) Параметры ЦПУ и оперативной памяти на ВМ. (see [below for nested schema](#nestedatt--flavor))
- `image` (Attributes) Тип вычислительного экземпляра. (see [below for nested schema](#nestedatt--image))
- `kafka_version` (String) Версия ядра Кафка.
- `label` (String) Метка заказа.
- `layout_id` (String) Layout ID из справочника geo_distribution.

### Optional

- `access` (Map of Set of String) Словарь,где ключом является роль, а значением список групп, которые предоставляют доступ для входа в Active Directory
- `acls` (Attributes Map) Список ACLS. (see [below for nested schema](#nestedatt--acls))
- `lifetime` (Number) Время жизни заказа в днях (2, 7, 14, 30)
- `quotas` (Attributes Set) Список квот (see [below for nested schema](#nestedatt--quotas))
- `retention_minutes` (Number) Сроки хранения указанные в минутах.
- `topics` (Attributes Map) Список топиков. (see [below for nested schema](#nestedatt--topics))
- `upgrade_kafka_distrib_mode` (String) Мод для регулировки политики обновлений версии дистрибутива ВТБ Кафка ("latest/none")
									если флаг проставлен в "latest", то будет запущено действие "Обновление версии дистрибутива"

### Read-Only

- `build_version` (String) Версия облачной сборки продукта.
- `connection_url` (String) Connection URL
- `item_id` (String) Идентификатор элемента ВМ в заказе. (становиться известен после создания заказа.)
- `order_id` (String) Идентификатор заказа (известен после создания заказа).

<a id="nestedatt--core"></a>
### Nested Schema for `core`

Required:

- `domain` (String) Название сетевого сегмента для заказа. Пример: dev-srv-app
- `net_segment` (String) Network segment name of order
- `platform` (String) Название платформы заказа Пример: OpenStack
- `zone` (String) Зона доступности, где будет размещен заказ. Пример: msk-north


<a id="nestedatt--extra_mounts"></a>
### Nested Schema for `extra_mounts`

Required:

- `size` (Number) Размер точки монтирования. (в ГБ)

Read-Only:

- `file_system` (String) Тип файловой системы.


<a id="nestedatt--flavor"></a>
### Nested Schema for `flavor`

Required:

- `cores` (Number) Количество ядер ЦПУ.
- `memory` (Number) Количество оперативной памяти RAM (указывается в ГБ).
- `name` (String) Кодовое название конфигурации.
- `uuid` (String) Уникальный идентификатор на странице справочников.


<a id="nestedatt--image"></a>
### Nested Schema for `image`

Required:

- `ad_integration` (Boolean) Флаг для интеграции вычислительного экземпляра с Active Directory.
- `default_kafka_version` (String) Версия брокеров Кафка по умолчанию.
- `distribution` (String) Название дистрибутива (RHEL или Astra).
- `geo_distribution` (Boolean) Механизм включения/выключения геораспределения.
- `on_support` (Boolean) Флаг означает, что продукт будет на поддержке у группы сопровождения.
- `os_version` (String) Версия образа дистрибутива.
- `product_id` (String) Идентификатор продукта экземпляра кластера Кафка.


<a id="nestedatt--acls"></a>
### Nested Schema for `acls`

Optional:

- `allow_idempotent` (Boolean) Добавленный для этого client_cn ACL поддерживает идемпотентные действия.
- `consumer_by_mask` (Set of String) Список масок, указанных в форме префикса, доступные клиенту для чтения/описания.
- `consumer_by_name` (Set of String) Список названий топиков, доступные клиенту для чтения/описания.
- `producer_by_mask` (Set of String) Список масок, указанных в префиксной форме, доступные клиенту записывать/создавать/описывать
- `producer_by_name` (Set of String) Список названий топиков, доступные клиенту для записи/создания/описания.
- `transactional_by_mask` (Set of String) Список транзакционных масок, разрешающих клиенту использовать его.
- `transactional_by_name` (Set of String) Список имен транзакций, разрешающих клиенту использовать его


<a id="nestedatt--quotas"></a>
### Nested Schema for `quotas`

Required:

- `producer_byte_rate` (Number) Скорость передачи байтов квоты производителя.
- `type` (String) Тип квоты (one of [default, personal])

Optional:

- `client_cn` (String) CN клиентского сертификата. Он может быть использован только для персональных квот.


<a id="nestedatt--topics"></a>
### Nested Schema for `topics`

Required:

- `cleanup_policy` (String) Политика очистки для данного топика.
- `partitions` (Number) Количество разделов в топике.

Optional:

- `compression_type` (String) Тип сжатия
- `retention_bytes` (Number) Максимальный размер для хранения данных в разделах указан в байтах.
- `retention_ms` (Number) Время удаления сегмента с данными, указанное в миллисекундах.
- `segment_size_mb` (Number) Максимальный размер для хранения данных в разделах указан в Мб.

## Import

Import is supported using the following syntax:

```shell
tofu import vtb_kafka_instance.kafka_powere_test2 <order_id>
```
