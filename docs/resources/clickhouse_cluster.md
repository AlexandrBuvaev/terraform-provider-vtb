---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vtb_clickhouse_cluster Resource - terraform-provider-vtb"
subcategory: ""
description: |-
  
---

# vtb_clickhouse_cluster (Resource)



## Example Usage

```terraform
data "vtb_core_data" "dev" {
  platform    = "OpenStack"
  domain      = "corp.dev.vtb"
  net_segment = "dev-srv-app"
  zone        = "msk-north"
}

data "vtb_flavor_data" "clickhouse_flavor" {
  cores  = 2
  memory = 4
}

data "vtb_flavor_data" "zookeeper_flavor" {
  cores  = 2
  memory = 4
}

data "vtb_clickhouse_cluster_image_data" "clickhouse_cluster_img" {
  distribution = "astra"
  os_version   = "1.8"
}

resource "vtb_clickhouse_cluster" "clickhouse_cluster_tf" {
  label     = "Terraform Clickhouse CLuster Astra"
  lifetime  = 2
  core      = data.vtb_core_data.dev
  flavor_ch = data.vtb_flavor_data.clickhouse_flavor
  flavor_zk = data.vtb_flavor_data.zookeeper_flavor
  image     = data.vtb_clickhouse_cluster_image_data.clickhouse_cluster_img
  nodes_count = {
    clickhouse = 2
  }
  financial_project = "VTB.Cloud"
  ch_extra_mounts = {
    "/app/clickhouse" = {
      size = 100
    }
  }
  zk_extra_mounts = {
    "/app/zookeeper" = {
      size = 80
    }
  }
  access = {
    "superuser" = [
      "cloud-soub-developers",
    ]
  }
  ch_version                 = "25.3.2.39"
  cluster_name               = "dev"
  ch_customer_admin          = "caaaaa1"
  ch_customer_admin_password = "lTLVycs!$dbq4zgZWN7TF$RI(Y*s4jUKCdudkz^J3j0A8v%lR4nFgy~23wWO@$qNm!ef"
  ch_customer_password       = "SU3Qd1zd7^g%)7hzWVXhoY!WxQmDQtcgJ0%p8GO5b~eipzfuRBs*CzIbqS9zY7H"
  system_adm_groups = {
    "system_adm_groups" = [
      "cloud-soub-developers1",
      "cloud-soub-developers2"
    ]
  }
  clickhouse_user_ad_groups = {
    "clickhouse_user_ad_groups" = [
      "cloud-soub-developers1",
    ]
  }

  clickhouse_app_admin_ad_groups = {
    "clickhouse_app_admin_ad_groups" = [
      "cloud-soub-developers1",
      "cloud-soub-developers2"
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `ch_customer_password` (String, Sensitive) Пароля для пользователя ClickHouse Customer
- `ch_extra_mounts` (Attributes Map) Дополнительные точки монтирования ВМ (see [below for nested schema](#nestedatt--ch_extra_mounts))
- `ch_version` (String) Версия ClickHouse
- `clickhouse_app_admin_ad_groups` (Map of Set of String) AD-группа с правами чтение таблиц
- `clickhouse_user_ad_groups` (Map of Set of String) AD-группа с правами на кластер: Select, Insert, Alter, Create table, Remote on
- `cluster_name` (String) Имя кластера
- `core` (Attributes) Основные параметры для виртуальных машин в заказе. (see [below for nested schema](#nestedatt--core))
- `financial_project` (String) Источник финансирования.
- `flavor_ch` (Attributes) Кол-во CPU/RAM для виртуальных машин. (see [below for nested schema](#nestedatt--flavor_ch))
- `flavor_zk` (Attributes) Кол-во CPU/RAM для виртуальных машин. (see [below for nested schema](#nestedatt--flavor_zk))
- `image` (Attributes) Type of compute instance (see [below for nested schema](#nestedatt--image))
- `label` (String) Метка заказа.
- `nodes_count` (Attributes) Кол-во нод (see [below for nested schema](#nestedatt--nodes_count))
- `zk_extra_mounts` (Attributes Map) Дополнительные точки монтирования ВМ (see [below for nested schema](#nestedatt--zk_extra_mounts))

### Optional

- `access` (Map of Set of String) Словарь,где ключом является роль, а значением список групп, которые предоставляют доступ для входа в Active Directory
- `ch_customer_admin` (String) Имя пользователя ClickHouse
- `ch_customer_admin_password` (String, Sensitive) Пароля для пользователя ClickHouse
- `lifetime` (Number) Время жизни заказа в днях (2, 7, 14, 30)
- `system_adm_groups` (Map of Set of String) AD-группа с полными правами на кластер

### Read-Only

- `item_id` (String) Идентификатор сущностей ВМ, известен после создания ВМ.
- `layout` (String) Схема геораспределения
- `order_id` (String) Идентификатор заказа. Становиться известен после создания заказа.
- `zk_version` (String) Версия Zookeeper

<a id="nestedatt--ch_extra_mounts"></a>
### Nested Schema for `ch_extra_mounts`

Required:

- `size` (Number) Размер точки монтированиия в ГБ

Read-Only:

- `file_system` (String) Тип файловой системы


<a id="nestedatt--core"></a>
### Nested Schema for `core`

Required:

- `domain` (String) Название сетевого сегмента для заказа. Пример: dev-srv-app
- `net_segment` (String) Network segment name of order
- `platform` (String) Название платформы заказа Пример: OpenStack
- `zone` (String) Зона доступности, где будет размещен заказ. Пример: msk-north


<a id="nestedatt--flavor_ch"></a>
### Nested Schema for `flavor_ch`

Required:

- `cores` (Number) Количество ядер ЦПУ.
- `memory` (Number) Количество оперативной памяти RAM (указывается в ГБ).
- `name` (String) Кодовое название конфигурации.
- `uuid` (String) Уникальный идентификатор на странице справочников.


<a id="nestedatt--flavor_zk"></a>
### Nested Schema for `flavor_zk`

Required:

- `cores` (Number) Количество ядер ЦПУ.
- `memory` (Number) Количество оперативной памяти RAM (указывается в ГБ).
- `name` (String) Кодовое название конфигурации.
- `uuid` (String) Уникальный идентификатор на странице справочников.


<a id="nestedatt--image"></a>
### Nested Schema for `image`

Required:

- `ad_integration` (Boolean) Флаг для интеграции виртуальной машины в Active Directory
- `distribution` (String) Название дистрибутива (RHEL или Astra).
- `geo_distribution` (Boolean) Механизм для включения/выключения геораспределения.
- `on_support` (Boolean) Флаг регулирущий режим работы группы сопровождения.
- `os_version` (String) Версия образа дистрибутива.
- `product_id` (String) Идентификатор продукта.


<a id="nestedatt--nodes_count"></a>
### Nested Schema for `nodes_count`

Optional:

- `clickhouse` (Number) Количество нод в кластере
- `zookeeper` (Number) Количество нод в кластере


<a id="nestedatt--zk_extra_mounts"></a>
### Nested Schema for `zk_extra_mounts`

Required:

- `size` (Number) Размер точки монтированиия в ГБ

Read-Only:

- `file_system` (String) Тип файловой системы

## Import

Import is supported using the following syntax:

```shell
terraform\tofu import vtb_clickhouse_cluster.<resource_name> <order_id>
```
